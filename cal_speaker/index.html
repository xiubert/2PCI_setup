<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Speaker calibration - Ca<sup>2+</sup> imaging in vivo</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Speaker calibration";
        var mkdocs_page_input_path = "cal_speaker.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Ca<sup>2+</sup> imaging in vivo
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../about/">About</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../hardware/">Hardware</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../software/">Software</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../configuration/">Configuration</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../operation/">Operation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../drivers/">Drivers</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../code/">Code</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../alignment/">2P Laser Alignment</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../cal_laser_power/">2P Laser Power calibration</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Speaker calibration</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#tools">Tools</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prerequisite-calibration-stimuli">Prerequisite: calibration stimuli</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#1-amp-setup">1. Amp setup</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#3-record-94-db-reference-voltage">3. Record 94 dB reference voltage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#4-record-stimuli-voltage">4. Record stimuli voltage</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#reference">Reference</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#volt2db">Volt2dB</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#dbwant2voltage">dBwant2voltage</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#vwant2gain">Vwant2gain</a>
    </li>
        </ul>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../computer_setup/">Rig Setup</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../pupillometry/">Pupillometry</a>
                </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Ca<sup>2+</sup> imaging in vivo</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Speaker calibration</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="speaker-calibration">Speaker calibration</h1>
<ul>
<li>Instructions for calibrating rig speaker</li>
<li><strong>Purpose</strong>: Speaker has nonlinear response across frequencies, must ensure voltage delivered to speaker corresponds to desired dB output for various signals</li>
<li><strong>Output</strong>: gain values corresponding to voltage needed to drive speaker to obtain desired dB SPL</li>
</ul>
<h2 id="tools">Tools</h2>
<ul>
<li>Oscilloscope: <a href="https://www.tek.com/en/oscilloscope/tds1001b-manual/tds1000b-and-tds2000b-series">Tektronix TDS2002B</a></li>
<li>microphone with attached pre-amp (1/8 inch 4138-A-015; Brüel and Kjær / HBK)</li>
<li>reference sound calibrator (Type 4231, Brüel and Kjær / HBK)</li>
<li>amp (Nexus 2690-0S Brüel and Kjær / HBK)</li>
<li>Brüel and Kjær / HBK tool contact: Isaac.farzaneh@hbkworld.com | 800-332-2040</li>
</ul>
<h2 id="prerequisite-calibration-stimuli">Prerequisite: calibration stimuli</h2>
<ul>
<li>Generate stimuli in MATLAB. See: <a href="https://github.com/xiubert/matlabPAC_general/tree/master/stimuliGeneration">stimuli generation code</a></li>
</ul>
<h2 id="1-amp-setup">1. Amp setup</h2>
<ol>
<li>Setup Menu: <img alt="Setup Menu" src="amp_setup1.png" /></li>
<li>Amplifier Set-up: Output sensitivity from Nexus amp<ul>
<li>Can set the output to 3.16 V/Pa as shown below. Make sure the band-pass filter is configured correctly so the system can read the 1000 Hz tone from the 4231 calibrator. Setting the filter to 0.1–100 kHz allows the full usable frequency range to pass through.</li>
<li>1 Pa corresponds to 94 dB</li>
<li><img alt="amp setup" src="amp_setup2.jpg" /></li>
</ul>
</li>
<li>Transducer Set-up:  Microphone sensitivity<ul>
<li>The nominal sensitivity of the 4939-A-011 is 4.419 mV/Pa, but if you have a calibration card for your specific microphone (inside microphone box), you should enter the actual calibrated sensitivity shown on the card.</li>
<li><img alt="transducer setup" src="amp_setup3.png" /></li>
</ul>
</li>
<li>Transducer Supply:  Microphone sensitivity<ul>
<li>Set the polarization voltage to 200 V. The 4939-A-011 is an externally polarized microphone, so it requires a 200 V polarization supply.</li>
<li><img alt="transducer supply" src="amp_setup4.jpg" /></li>
</ul>
</li>
</ol>
<h2 id="3-record-94-db-reference-voltage">3. Record 94 dB reference voltage</h2>
<ul>
<li>1 Pa corresponds to 94 dB. Type 4231 reference speaker outputs 1 kHz at 94 dB. Thus, if output sensitivity set to 3.16 V / Pa, should see 3.16 V RMS on oscilloscope with 'Autoset'</li>
</ul>
<h2 id="4-record-stimuli-voltage">4. Record stimuli voltage</h2>
<ul>
<li>Set gain to 1800 and record voltage to oscilloscope for stimuli that are to be calibrated<ul>
<li><strong>Ensure oscilloscope channel set to 1X (eg. Ch 1 Menu): Probe 1X Voltage</strong></li>
</ul>
</li>
<li>Can use scripts <a href="github.com/xiubert/matlabPAC_general/blob/master/speakerCalibration/speakerCal_oscDataFile.m">pure tones</a> and <a href="https://github.com/xiubert/matlabPAC_general/blob/master/speakerCalibration/speakerCal_oscToneCycleVrms.m">all other stimuli (BPN etc)</a></li>
</ul>
<h2 id="reference">Reference</h2>
<ul>
<li>see: <a href="https://github.com/xiubert/matlabPAC_general/tree/master/helperFcns/auditory">sound level equations</a></li>
</ul>
<h3 id="volt2db">Volt2dB</h3>
<pre><code>dB = 20 · log₁₀(V_out/V_ref) + dB_ref
</code></pre>
<h3 id="dbwant2voltage">dBwant2voltage</h3>
<pre><code>dB = 20 · log₁₀(V_want/V_ref) + dB_ref

[  ] = (dB - dB_ref)/20

10^[(dB - dB_ref)/20]

V_want/V_ref = 10^((dB - dB_ref)/20)

V_want = 10^((dB - dB_ref)/20) · V_ref
</code></pre>
<h3 id="vwant2gain">Vwant2gain</h3>
<pre><code>V_Gref/G_ref = V_want/G_set

G_set = G_ref · (V_want/V_Gref)
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../cal_laser_power/" class="btn btn-neutral float-left" title="2P Laser Power calibration"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../computer_setup/" class="btn btn-neutral float-right" title="Rig Setup">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../cal_laser_power/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../computer_setup/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
